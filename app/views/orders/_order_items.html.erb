<!-- app/views/orders/_order_items.html.erb -->
<% if order_items.any? %>
  <h2>Produse ComandÄƒ #<%= order.id %></h2>
  
  <table>
    <thead>
      <tr>
        <th>Produs</th>
        <th>Cant.</th>
        <th>PreÈ›</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
      <% order_items.each do |item| %>
        <tr>
          <td><%= item.product_name %></td>
          <td><%= item.quantity %></td>
          <td><%= number_to_currency(item.price, unit: "RON ", separator: ",", delimiter: ".") %></td>
          <td><%= number_to_currency(item.total_price, unit: "RON ", separator: ",", delimiter: ".") %></td>
        </tr>
      <% end %>
      <tr>
        <td colspan="3">Total Ordin:</td>
        <td><%= number_to_currency(order.total, unit: "RON ", separator: ",", delimiter: ".") %></td>
      </tr>
    </tbody>
  </table>

  <!-- Date de Facturare - TOATE cÃ¢mpurile pe o linie -->
  <div style="padding: 15px 20px; border-top: 1px solid #e9ecef; font-size: 12px; line-height: 1.8;">
    <strong style="color: #8b0000;">ðŸ“„ Facturare:</strong>
    <%= order.first_name %> <%= order.last_name %>
    <% if order.company_name.present? %>
      â€¢ Companie: <%= order.company_name %>
    <% end %>
    <% if order.cui.present? %>
      â€¢ CUI: <%= order.cui %>
    <% end %>
    <% if order.cnp.present? %>
      â€¢ CNP: <%= order.cnp %>
    <% end %>
    â€¢ <%= order.email %>
    â€¢ <%= order.phone %>
    â€¢ <%= order.street %> <%= order.street_number %>
    <% if order.block_details.present? %>
      , <%= order.block_details %>
    <% end %>
    â€¢ <%= order.city %>, <%= order.county %>, <%= order.postal_code %>
    â€¢ <%= order.country %>
  </div>

  <!-- Date de Livrare - cu indicator vizual -->
  <% 
    shipping_different = order.shipping_first_name.present? && (
      order.shipping_first_name != order.first_name ||
      order.shipping_street != order.street ||
      order.shipping_city != order.city
    )
  %>

  <% if shipping_different %>
    <!-- Adrese DIFERITE - roÈ™u -->
    <div style="padding: 15px 20px; border-top: 1px solid #e9ecef; border-left: 4px solid #dc3545; background-color: #fff5f5; font-size: 12px; line-height: 1.8;">
      <div style="margin-bottom: 8px;">
        <span style="display: inline-block; background-color: #dc3545; color: white; padding: 3px 10px; border-radius: 12px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
          ðŸ”´ AdresÄƒ de livrare diferitÄƒ
        </span>
      </div>
      <strong style="color: #8b0000;">ðŸ“¦ Livrare:</strong>
      <%= order.shipping_first_name %> <%= order.shipping_last_name %>
      <% if order.shipping_company_name.present? %>
        â€¢ Companie: <%= order.shipping_company_name %>
      <% end %>
      â€¢ <%= order.shipping_phone %>
      â€¢ <%= order.shipping_street %> <%= order.shipping_street_number %>
      <% if order.shipping_block_details.present? %>
        , <%= order.shipping_block_details %>
      <% end %>
      â€¢ <%= order.shipping_city %>, <%= order.shipping_county %>, <%= order.shipping_postal_code %>
      â€¢ <%= order.shipping_country %>
    </div>
  <% else %>
    <!-- Adrese IDENTICE - verde -->
    <div style="padding: 15px 20px; border-top: 1px solid #e9ecef; border-left: 4px solid #28a745; background-color: #f0fff4; font-size: 12px;">
      <span style="display: inline-block; background-color: #28a745; color: white; padding: 3px 10px; border-radius: 12px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
        ðŸŸ¢ AdresÄƒ unicÄƒ
      </span>
      <span style="color: #28a745; font-weight: 500; margin-left: 8px;">
        Livrare È™i facturare la aceeaÈ™i adresÄƒ
      </span>
    </div>
  <% end %>

  <div class="back-button-container">
    <%= link_to 'ÃŽnapoi la Lista', orders_path, class: 'btn btn-secondary' %>
  </div>

<% else %>
  <h2>Detalii Ordin</h2>
  <p>Nu existÄƒ produse pentru acest ordin.</p>
  <div class="back-button-container">
    <%= link_to 'ÃŽnapoi la Lista', orders_path, class: 'btn btn-secondary' %>
  </div>
<% end %>